<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>屠龙宝刀点击就送（帅的才送）</title>
  
  <!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-7WJ6L7RK5W"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-7WJ6L7RK5W');
</script>

<style>
  :root {
    --bg: #0f1325;
    --panel: #182039;
    --line: #26325d;
    --text: #eaf0ff;
    --muted: #a8b2d2;
    --accent: #86a8ff;
    --accent2: #9df0d7;
    --danger: #ff6b6b;
    --success: #4cd97c;
    --crit: #ffcc00;
    --emo-color: #d3d3d3;
    --emo-dark: #a8a8a8;
  }
  
  * {
    box-sizing: border-box;
    margin: 0;
    padding: 0;
  }
  
  html, body {
    min-height: 100%;
    background: radial-gradient(1000px 600px at 10% -10%, #1b2350 0, transparent 60%),
                radial-gradient(900px 500px at 110% 10%, #232f5f 0, transparent 60%), 
                var(--bg);
    color: var(--text);
    font: 16px/1.6 system-ui, -apple-system, Segoe UI, Roboto, "Microsoft YaHei", sans-serif;
    overflow-x: hidden;
  }
  
  .wrap {
    width: min(860px, 100%);
    margin: 20px auto;
    display: grid;
    gap: 14px;
    padding: 0 14px;
  }
  
  .card {
    background: linear-gradient(180deg, rgba(255,255,255,.03), rgba(255,255,255,.01));
    border: 1px solid var(--line);
    border-radius: 14px;
    padding: 16px;
    position: relative;
    overflow: hidden;
  }
  
  h1 {
    margin: 0 0 6px;
    font-size: 24px;
    line-height: 1.35;
  }
  
  .lead {
    margin: 6px 0 0;
    font-size: 18px;
    font-weight: 600;
    letter-spacing: .2px;
  }
  
  .muted {
    color: var(--muted);
    font-size: 14px;
  }
  
  .row {
    display: flex;
    gap: 12px;
    flex-wrap: wrap;
  }
  
  button {
    appearance: none;
    border: none;
    cursor: pointer;
    font-weight: 700;
    border-radius: 12px;
    padding: 10px 14px;
    color: #0b1233;
    background: linear-gradient(90deg, var(--accent), var(--accent2));
    box-shadow: 0 8px 20px rgba(134,168,255,.25);
    transition: transform .05s ease;
  }
  
  button:active {
    transform: translateY(1px) scale(.99);
  }
  
  .type {
    border-right: 2px solid var(--accent);
    white-space: pre-wrap;
    min-height: 1.6em;
  }
  
  .tag {
    display: inline-block;
    padding: 3px 10px;
    border: 1px solid var(--line);
    border-radius: 999px;
    color: var(--muted);
    font-size: 12px;
    margin-bottom: 8px;
  }
  
  footer {
    color: var(--muted);
    font-size: 12px;
    text-align: center;
    padding: 10px;
  }
  
  .headcopy {
    position: relative;
    z-index: 1;
  }
  
  /* 游戏区域样式 */
  #game-area {
    display: none;
    margin-top: 20px;
    text-align: center;
  }
  
  #emo-monster {
    width: 120px;
    height: 120px;
    margin: 0 auto 15px;
    background: linear-gradient(135deg, var(--emo-color), var(--emo-dark));
    border-radius: 50% 50% 40% 40%;
    position: relative;
    box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
    cursor: pointer;
    transition: transform 0.2s;
  }
  
  .eye {
    position: absolute;
    width: 30px;
    height: 30px;
    background: white;
    border-radius: 50%;
    top: 35px;
  }
  
  .eye.left {
    left: 25px;
  }
  
  .eye.right {
    right: 25px;
  }
  
  .pupil {
    position: absolute;
    width: 15px;
    height: 15px;
    background: #333;
    border-radius: 50%;
    top: 7px;
    left: 7px;
  }
  
  /* 死亡表情 */
  .dead-eye {
    position: absolute;
    width: 30px;
    height: 30px;
    top: 35px;
  }
  
  .dead-eye::before,
  .dead-eye::after {
    content: "";
    position: absolute;
    height: 3px;
    background: #333;
    top: 14px;
    left: 0;
    width: 100%;
  }
  
  .dead-eye::before {
    transform: rotate(45deg);
  }
  
  .dead-eye::after {
    transform: rotate(-45deg);
  }
  
  .dead-eye.left {
    left: 25px;
  }
  
  .dead-eye.right {
    right: 25px;
  }
  
  #health-container {
    width: 250px;
    margin: 0 auto 15px;
  }
  
  #health-text {
    text-align: center;
    margin-bottom: 5px;
    font-size: 14px;
  }
  
  #health-bar {
    width: 100%;
    height: 20px;
    background: var(--panel);
    border-radius: 10px;
    overflow: hidden;
    border: 1px solid var(--line);
  }
  
  #health {
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, var(--danger), #ff8e8e);
    transition: width 0.3s;
  }
  
  /* 增大屠龙宝刀图标 */
  #sword {
    display: none;
    position: absolute;
    width: 80px;  /* 从40px增加到80px */
    height: 80px; /* 从40px增加到80px */
    background: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><path fill="%23ffd700" d="M50 10L60 40H40L50 10z"/><rect x="48" y="40" width="4" height="50" fill="%23c0c0c0"/><rect x="45" y="90" width="10" height="5" fill="%23a52a2a"/><rect x="40" y="95" width="20" height="5" fill="%238b4513"/><circle cx="50" cy="20" r="5" fill="%23red"/></svg>') no-repeat center/contain;
    pointer-events: none;
    z-index: 100;
    transform-origin: center 70%; /* 调整旋转中心点 */
    filter: drop-shadow(0 0 5px rgba(255, 215, 0, 0.8));
  }
  
  /* 伤害数值样式 */
  .damage-text {
    position: absolute;
    font-weight: bold;
    pointer-events: none;
    z-index: 200;
    text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.8);
    animation: floatUp 1s forwards;
  }
  
  @keyframes floatUp {
    0% {
      transform: translateY(0);
      opacity: 1;
    }
    100% {
      transform: translateY(-50px);
      opacity: 0;
    }
  }
  
  .crit-text {
    color: var(--crit);
    font-size: 20px;
    animation: critFloat 1s forwards;
  }
  
  @keyframes critFloat {
    0% {
      transform: translateY(0) scale(1);
      opacity: 1;
    }
    50% {
      transform: translateY(-25px) scale(1.5);
    }
    100% {
      transform: translateY(-50px) scale(1);
      opacity: 0;
    }
  }
  
  /* 暴击特效 */
  .crit-effect {
    position: absolute;
    width: 100%;
    height: 100%;
    pointer-events: none;
    z-index: 150;
    background: radial-gradient(circle, rgba(255, 204, 0, 0.4) 0%, transparent 70%);
    animation: critFlash 0.5s forwards;
  }
  
  @keyframes critFlash {
    0% {
      opacity: 1;
      transform: scale(0.5);
    }
   100% {
      opacity: 0;
      transform: scale(1.5);
    }
  }
  
  /* 暴击提示 */
  .crit-tip {
    text-align: center;
    margin-top: 10px;
    font-size: 12px;
    color: var(--crit);
    animation: pulse 2s infinite;
  }
  
  @keyframes pulse {
    0% { opacity: 0.7; }
    50% { opacity: 1; }
    100% { opacity: 0.7; }
  }
  
  /* 音乐控制 */
  .music-control {
    position: fixed;
    bottom: 20px;
    right: 20px;
    z-index: 1000;
    background: var(--panel);
    border: 1px solid var(--line);
    border-radius: 50%;
    width: 50px;
    height: 50px;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
  }
  
  .music-control i {
    font-size: 24px;
    color: var(--accent);
  }
  
  .music-control.muted i {
    color: var(--muted);
  }
  
  /* 弹窗样式 */
  .modal {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(15, 19, 37, 0.9);
    z-index: 1000;
    justify-content: center;
    align-items: center;
  }
  
  .modal-content {
    background: var(--panel);
    border: 1px solid var(--line);
    border-radius: 14px;
    padding: 25px;
    max-width: 400px;
    width: 90%;
    text-align: center;
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
  }
  
  .modal h2 {
    margin-bottom: 15px;
    color: var(--accent);
  }
  
  .modal p {
    margin-bottom: 20px;
  }
  
  .modal-buttons {
    display: flex;
    justify-content: center;
    gap: 15px;
  }
  
  .modal-btn {
    min-width: 80px;
  }
  
  .modal-btn.yes {
    background: linear-gradient(90deg, var(--success), #6cdf9c);
  }
  
  /* 响应式设计 */
  @media (max-width: 480px) {
    h1 { font-size: 22px; }
    .lead { font-size: 16px; }
    .row { flex-direction: column; }
    #emo-monster { width: 100px; height: 100px; }
    #health-container { width: 200px; }
    .eye, .dead-eye {
      width: 25px;
      height: 25px;
      top: 30px;
    }
    .eye.left, .dead-eye.left { left: 20px; }
    .eye.right, .dead-eye.right { right: 20px; }
    .pupil {
      width: 12px;
      height: 12px;
      top: 6px;
      left: 6px;
    }
    #sword {
      width: 60px;
      height: 60px;
    }
    .music-control {
      bottom: 10px;
      right: 10px;
      width: 40px;
      height: 40px;
    }
    .music-control i {
      font-size: 20px;
    }
  }
</style>
<!-- 引入字体图标 -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
<div class="wrap">
  <header class="card">
    <div class="headcopy">
      <h1>哦莫，<span id="toName">是谁在发光！</span>好闪！ ✨</h1>
      <p class="lead">原来是唱歌又好听、长得又好看、游戏还打得好的、做什么都会成功的 <b>全世界最好的 巴zei 同学</b>呀！</p>
      <div class="muted">努力的巴zei同学很酷，但是能停下来发发呆看看云的巴zei同学更！是！超！级！酷！</div>
    </div>
  </header>

  <div class="card">
    <div class="tag">🎯 今天的巴zei同学开心了吗？</div>
    <p id="quote" class="type"></p>
    <div class="row">
      <button id="btnNew">长得帅的都点我</button>
      <button id="btnGetSword">点击领取屠龙宝刀</button>
      <span class="muted" style="align-self:center">领取宝刀后，点击emo怪进行攻击</span>
    </div>
    <div id="counter" class="muted" style="text-align: right; margin-top: 8px; font-size: 12px;">已展示: 0/10</div>
  </div>

  <!-- 游戏区域 -->
  <div id="game-area" class="card">
    <div class="tag">⚔️ 巴zei大侠大战emo怪</div>
    <div id="health-container">
      <div id="health-text">HP: 8888/8888</div>
      <div id="health-bar">
        <div id="health"></div>
      </div>
    </div>
    <div id="emo-monster">
      <div class="eye left"><div class="pupil"></div></div>
      <div class="eye right"><div class="pupil"></div></div>
    </div>
    <p class="muted">使用屠龙宝刀点击emo怪进行攻击！</p>
    <div class="crit-tip">💥 越强越帅暴击概率越大！</div>
  </div>

  <footer>© <span id="year"></span> 遇事不要慌，还能找丫丫</footer>
</div>

<!-- 屠龙宝刀图标 -->
<div id="sword"></div>

<!-- 音乐控制 -->
<div id="music-control" class="music-control">
  <i class="fas fa-volume-up"></i>
</div>

<!-- 弹窗 -->
<div id="victory-modal" class="modal">
  <div class="modal-content">
    <h2>🎉 巴zei少侠完胜emo怪</h2>
    <p>恭喜你成功击败了emo怪！</p>
    <button id="confirm-victory" class="modal-btn">确认</button>
  </div>
</div>

<div id="loot-modal" class="modal">
  <div class="modal-content">
    <h2>🎁 掉落装备</h2>
    <p>是否捡取掉落装备？</p>
    <div class="modal-buttons">
      <button id="btn-yes" class="modal-btn yes">是</button>
      <button id="btn-ofcourse" class="modal-btn">当然</button>
    </div>
  </div>
</div>

<div id="buff-modal" class="modal">
  <div class="modal-content">
    <h2>✨ 获得永久Buff</h2>
    <p>成功获得永久buff：<strong>巴zei少侠天天开心</strong></p>
    <button id="close-buff" class="modal-btn">太棒了！</button>
  </div>
</div>

<!-- 文案存 JSON -->
<script type="application/json" id="quotes-json">
[
  "卧槽，瞧瞧，这是谁？是全世界最好的巴zei同学！",
  "巴zei同学年纪轻轻完成人生小目标，躺，这得躺！",
  "心即理也。",
  "身体才是革命的本钱。",
  "与其逼自己一把，不如放自己一马。",
  "可是我们巴zei同学，就是很好很好会发光呀～",
  "躺平不是摆烂，是休养生息～",
  "巴zei同学值得拥有世界上所有的好东西。",
  "你不会有过不去的坎，因为你的腿不够短。",
  "少侠要在江湖有一席之地，需得劳逸结合。",
  "总裁也需要适当摸鱼。",
  "大方向你已经完事儿了，现在需要的是享受！享受人生，就 咱快乐就完事儿了！！"
]
</script>

<!-- 音频元素 - 使用您提供的GitHub链接 -->
<audio id="bgm" src="https://github.com/pyx0320/To-the-best-ba-zei/raw/main/bgm_emo%E6%80%AA.mp3" loop preload="auto"></audio>

<audio id="attack-sound">
  <source src="https://cdn.pixabay.com/download/audio/2022/03/15/audio_5bdcb6f6e7.mp3?filename=whoosh-6316.mp3" type="audio/mpeg">
</audio>

<audio id="crit-sound">
  <source src="https://cdn.pixabay.com/download/audio/2022/03/19/audio_2a5525d600.mp3?filename=power-up-6768.mp3" type="audio/mpeg">
</audio>

<audio id="victory-sound">
  <source src="https://cdn.pixabay.com/download/audio/2021/10/25/audio_7b60723d8c.mp3?filename=success-1-6297.mp3" type="audio/mpeg">
</audio>

<script>
  const $ = s => document.querySelector(s);
  const elQuote = $("#quote"), elYear = $("#year"), elCounter = $("#counter");
  const btnNew = $("#btnNew"), btnGetSword = $("#btnGetSword");
  const gameArea = $("#game-area"), emoMonster = $("#emo-monster");
  const healthBar = $("#health"), healthText = $("#health-text");
  const sword = $("#sword");
  const victoryModal = $("#victory-modal"), lootModal = $("#loot-modal");
  const buffModal = $("#buff-modal");
  const musicControl = $("#music-control");
  
  // 音频元素
  const bgm = $("#bgm");
  const attackSound = $("#attack-sound");
  const critSound = $("#crit-sound");
  const victorySound = $("#victory-sound");
  
  // 解析 JSON 文案
  let QUOTES = [];
  try {
    QUOTES = JSON.parse(document.getElementById('quotes-json').textContent.trim());
  } catch(e) {
    QUOTES = ["文案解析失败，但你依然很酷。"];
  }

  // 游戏变量
  let hasSword = false;
  let monsterHealth = 8888;
  let maxHealth = 8888;
  let typeTimer = null;
  let attackCooldown = false;
  let isMonsterDead = false;
  let hitCount = 0;
  let isMusicPlaying = false;
  
  // 文案显示管理
  let usedIndices = new Set();
  let currentIndex = -1;
  
  function updateCounter() {
    elCounter.textContent = `已展示: ${usedIndices.size}/${QUOTES.length}`;
  }
  
  function typeText(el, text, speed = 18) {
    if (typeTimer) {
      clearInterval(typeTimer);
      typeTimer = null;
    }
    
    let i = 0; 
    el.textContent = "";
    
    el.classList.remove("type");
    void el.offsetWidth;
    el.classList.add("type");
    
    typeTimer = setInterval(() => {
      if (i < text.length) {
        el.textContent += text[i];
        i++;
      } else {
        clearInterval(typeTimer);
        typeTimer = null;
      }
    }, speed);
  }

  function newQuote() {
    // 如果所有文案都已使用过，重置
    if (usedIndices.size >= QUOTES.length) {
      usedIndices.clear();
    }
    
    // 创建一个可用索引数组
    const availableIndices = [];
    for (let i = 0; i < QUOTES.length; i++) {
      if (!usedIndices.has(i) && i !== currentIndex) {
        availableIndices.push(i);
      }
    }
    
    // 随机选择一个可用索引
    if (availableIndices.length > 0) {
      const randomIndex = Math.floor(Math.random() * availableIndices.length);
      currentIndex = availableIndices[randomIndex];
      usedIndices.add(currentIndex);
      
      const pick = QUOTES[currentIndex];
      typeText(elQuote, pick);
      updateCounter();
    }
  }

  // 初始化屠龙宝刀
  function initSword() {
    hasSword = true;
    sword.style.display = "block";
    gameArea.style.display = "block";
    btnGetSword.textContent = "已领取屠龙宝刀";
    btnGetSword.disabled = true;
    
    // 开始播放BGM
    playBGM();
    
    // 宝刀跟随鼠标
    document.addEventListener("mousemove", moveSword);
    
    // 点击emo怪事件
    emoMonster.addEventListener("click", attackMonster);
  }
  
  function moveSword(e) {
    // 调整位置偏移，使宝刀中心对准鼠标
    sword.style.left = (e.pageX - 40) + "px"; // 从-20改为-40，因为宝刀变大了
    sword.style.top = (e.pageY - 40) + "px"; // 从-20改为-40，因为宝刀变大了
  }
  
  function attackMonster() {
    if (!hasSword || attackCooldown || isMonsterDead) return;
    
    // 攻击冷却
    attackCooldown = true;
    setTimeout(() => {
      attackCooldown = false;
    }, 200);
    
    // 攻击动画 - 增加更明显的挥动效果
    sword.style.transform = "rotate(-45deg) translateY(5px)";
    setTimeout(() => {
      sword.style.transform = "rotate(0deg) translateY(0)";
    }, 150);
    
    // 计算暴击概率 (随着攻击次数增加而提高)
    hitCount++;
    let critChance = 0.15 + (Math.min(hitCount, 20) * 0.01);
    let isCrit = Math.random() < critChance;
    
    // 计算伤害 (基础伤害 + 随机伤害)
    let baseDamage = isCrit ? 166 : 66;
    let randomDamage = Math.floor(Math.random() * 16);
    let totalDamage = baseDamage + randomDamage;
    
    // 应用伤害
    monsterHealth -= totalDamage;
    if (monsterHealth < 0) monsterHealth = 0;
    
    // 更新血条
    healthBar.style.width = (monsterHealth / maxHealth * 100) + "%";
    healthText.textContent = `HP: ${monsterHealth}/${maxHealth}`;
    
    // 播放音效
    if (isCrit) {
      playSound(critSound);
    } else {
      playSound(attackSound);
    }
    
    // 显示伤害数值
    showDamage(totalDamage, isCrit);
    
    // 怪物受击动画
    emoMonster.style.transform = "scale(0.9)";
    setTimeout(() => {
      emoMonster.style.transform = "scale(1)";
    }, 200);
    
    // 检查是否击败
    if (monsterHealth <= 0) {
      isMonsterDead = true;
      updateMonsterFace(true);
      // 停止BGM
      pauseBGM();
      // 播放胜利音效
      playSound(victorySound);
      setTimeout(() => {
        victoryModal.style.display = "flex";
      }, 500);
    }
  }
  
  function showDamage(amount, isCrit) {
    // 创建伤害文本元素
    const damageText = document.createElement('div');
    damageText.className = `damage-text ${isCrit ? 'crit-text' : ''}`;
    damageText.textContent = isCrit ? `暴击! -${amount}` : `-${amount}`;
    
    // 设置位置
    const rect = emoMonster.getBoundingClientRect();
    damageText.style.left = `${rect.left + rect.width/2}px`;
    damageText.style.top = `${rect.top}px`;
    
    // 添加到页面
    document.body.appendChild(damageText);
    
    // 暴击特效
    if (isCrit) {
      const critEffect = document.createElement('div');
      critEffect.className = 'crit-effect';
      critEffect.style.left = `${rect.left}px`;
      critEffect.style.top = `${rect.top}px`;
      critEffect.style.width = `${rect.width}px`;
      critEffect.style.height = `${rect.height}px`;
      document.body.appendChild(critEffect);
      
      // 移除特效元素
      setTimeout(() => {
        document.body.removeChild(critEffect);
      }, 500);
    }
    
    // 移除文本元素
    setTimeout(() => {
      document.body.removeChild(damageText);
    }, 1000);
  }
  
  // 更新emo怪表情
  function updateMonsterFace(isDead) {
    const eyes = emoMonster.querySelectorAll('.eye');
    const pupils = emoMonster.querySelectorAll('.pupil');
    
    if (isDead) {
      // 移除正常眼睛
      eyes.forEach(eye => eye.style.display = 'none');
      pupils.forEach(pupil => pupil.style.display = 'none');
      
      // 添加死亡眼睛
      const leftDeadEye = document.createElement('div');
      leftDeadEye.className = 'dead-eye left';
      emoMonster.appendChild(leftDeadEye);
      
      const rightDeadEye = document.createElement('div');
      rightDeadEye.className = 'dead-eye right';
      emoMonster.appendChild(rightDeadEye);
      
      // 改变emo怪颜色
      emoMonster.style.background = 'linear-gradient(135deg, #696969, #808080)';
    } else {
      // 恢复正常眼睛
      eyes.forEach(eye => eye.style.display = 'block');
      pupils.forEach(pupil => pupil.style.display = 'block');
      
      // 移除死亡眼睛
      const deadEyes = emoMonster.querySelectorAll('.dead-eye');
      deadEyes.forEach(eye => eye.remove());
      
      // 恢复emo怪颜色
      emoMonster.style.background = 'linear-gradient(135deg, var(--emo-color), var(--emo-dark))';
    }
  }
  
  // 音频控制函数
  function playBGM() {
    bgm.volume = 0.5; // 设置音量
    bgm.play().catch(e => {
      console.log("自动播放BGM被阻止，需要用户交互");
    });
    isMusicPlaying = true;
    musicControl.classList.remove("muted");
  }
  
  function pauseBGM() {
    bgm.pause();
    isMusicPlaying = false;
    musicControl.classList.add("muted");
  }
  
  function playSound(sound) {
    sound.currentTime = 0; // 重置音频到开始
    sound.volume = 0.5; // 设置音量
    sound.play().catch(e => {
      console.log("播放音效失败", e);
    });
  }
  
  // 弹窗流程
  $("#confirm-victory").addEventListener("click", () => {
    victoryModal.style.display = "none";
    lootModal.style.display = "flex";
  });
  
  $("#btn-yes").addEventListener("click", () => {
    lootModal.style.display = "none";
    buffModal.style.display = "flex";
  });
  
  $("#btn-ofcourse").addEventListener("click", () => {
    lootModal.style.display = "none";
    buffModal.style.display = "flex";
  });
  
  $("#close-buff").addEventListener("click", () => {
    buffModal.style.display = "none";
    // 重新开始游戏
    location.reload();
  });
  
  // 初始化
  (function init() { 
    elYear.textContent = new Date().getFullYear(); 
    newQuote(); 
    
    // 添加事件监听
    btnNew.addEventListener("click", e => { 
      e.stopPropagation(); 
      newQuote(); 
    });
    
    btnGetSword.addEventListener("click", e => { 
      e.stopPropagation(); 
      initSword(); 
    });
    
    // 音乐控制
    musicControl.addEventListener("click", () => {
      if (isMusicPlaying) {
        pauseBGM();
      } else {
        playBGM();
      }
    });
  })();
</script>
</body>
</html>
